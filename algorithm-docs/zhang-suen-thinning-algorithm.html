<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet"
        href="https://gist.githubusercontent.com/bgoonz/37bca66ce8441c688900b6f082f10560/raw/2e9a5966431d89b8ce6355e7b8039ba42554978b/CSS-Styling-for-Pandoc-generated-html.css">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"
        integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z" crossorigin="anonymous">
    <link rel="stylesheet"
        href="https://raw.githubusercontent.com/bgoonz/styling-templates/master/bootstrap3/assets/css/bootstrap.min.css">
</head>

<body>;
    <h1 id="description">–description–</h1>
    <p>This is an algorithm used to thin a black and white i.e. one bit per pixel images. For example, with an input
        image of:</p>
    <!-- TODO write fully in markdown>
<!-- markdownlint-disable -->
    <pre>
 #################                   #############
 ##################               ################
 ###################            ##################
 ########     #######          ###################
   ######     #######         #######       ######
   ######     #######        #######
   #################         #######
   ################          #######
   #################         #######
   ######     #######        #######
   ######     #######        #######
   ######     #######         #######       ######
 ########     #######          ###################
 ########     ####### ######    ################## ######
 ########     ####### ######      ################ ######
 ########     ####### ######         ############# ######
</pre>
    <p>It produces the thinned output:</p>
    <pre>

    # ##########                       #######
     ##        #                   ####       #
     #          #                 ##
     #          #                #
     #          #                #
     #          #                #
     ############               #
     #          #               #
     #          #                #
     #          #                #
     #          #                #
     #                            ##
     #                             ############
                       ###                          ###

</pre>
    <h2>
        Algorithm
    </h2>
    <p>Assume black pixels are one and white pixels zero, and that the input image is a rectangular N by M array of ones
        and zeroes. The algorithm operates on all black pixels P1 that can have eight neighbours. The neighbours are, in
        order, arranged as:</p>
    <table border="3">
        <tr>
            <td style="text-align: center;">
                P9
            </td>
            <td style="text-align: center;">
                P2
            </td>
            <td style="text-align: center;">
                P3
            </td>
        </tr>
        <tr>
            <td style="text-align: center;">
                P8
            </td>
            <td style="text-align: center;">
                <strong>P1</strong>
            </td>
            <td style="text-align: center;">
                P4
            </td>
        </tr>
        <tr>
            <td style="text-align: center;">
                P7
            </td>
            <td style="text-align: center;">
                P6
            </td>
            <td style="text-align: center;">
                P5
            </td>
        </tr>
    </table>
    <p>Obviously the boundary pixels of the image cannot have the full eight neighbours.</p>
    <ul>
        <li>
            Define <span class="math inline"><em>A</em>(<em>P</em>1)</span> = the number of transitions from white to
            black, (0 -&gt; 1) in the sequence P2, P3, P4, P5, P6, P7, P8, P9, P2. (Note the extra P2 at the end - it is
            circular).
        </li>
        <li>
            Define <span class="math inline"><em>B</em>(<em>P</em>1)</span> = the number of black pixel neighbours of
            P1. ( = sum(P2 .. P9) )
        </li>
    </ul>
    <h3>
        Step 1:
    </h3>
    <p>All pixels are tested and pixels satisfying all the following conditions (simultaneously) are just noted at this
        stage.</p>
    <ol>
        <li>
            The pixel is black and has eight neighbours
        </li>
        <li>
            <span class="math inline">2 &lt;  = <em>B</em>(<em>P</em>1) &lt;  = 6</span>
        </li>
        <li>
            <span class="math inline"><em>A</em>(<em>P</em>1) = 1</span>
        </li>
        <li>
            At least one of <strong>P2, P4 and P6</strong> is white
        </li>
        <li>
            At least one of <strong>P4, P6 and P8</strong> is white
        </li>
    </ol>
    <p>After iterating over the image and collecting all the pixels satisfying all step 1 conditions, all these
        condition satisfying pixels are set to white.</p>
    <h3>
        Step 2:
    </h3>
    <p>All pixels are again tested and pixels satisfying all the following conditions are just noted at this stage.</p>
    <ol>
        <li>
            The pixel is black and has eight neighbours
        </li>
        <li>
            <span class="math inline">2 &lt;  = <em>B</em>(<em>P</em>1) &lt;  = 6</span>
        </li>
        <li>
            <span class="math inline"><em>A</em>(<em>P</em>1) = 1</span>
        </li>
        <li>
            At least one of <strong>P2, P4 and P8</strong> is white
        </li>
        <li>
            At least one of <strong>P2, P6 and P8</strong> is white
        </li>
    </ol>
    <p>After iterating over the image and collecting all the pixels satisfying all step 2 conditions, all these
        condition satisfying pixels are again set to white.</p>
    <h3>
        Iteration:
    </h3>
    <p>If any pixels were set in this round of either step 1 or step 2 then all steps are repeated until no image pixels
        are so changed.</p>
    <h1 id="instructions">–instructions–</h1>
    <p>Write a routine to perform Zhang-Suen thinning on the provided image matrix.</p>
    <h1 id="hints">–hints–</h1>
    <p><code>thinImage</code> should be a function.</p>
    <div class="sourceCode" id="cb1">
        <pre
            class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb1-1" title="1"><span class="va">assert</span>.<span class="at">equal</span>(<span class="kw">typeof</span> thinImage<span class="op">,</span> <span class="st">&#39;function&#39;</span>)<span class="op">;</span></a></code></pre>
    </div>
    <p><code>thinImage</code> should return an array.</p>
    <div class="sourceCode" id="cb2">
        <pre
            class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb2-1" title="1"><span class="at">assert</span>(<span class="va">Array</span>.<span class="at">isArray</span>(result))<span class="op">;</span></a></code></pre>
    </div>
    <p><code>thinImage</code> should return an array of strings.</p>
    <div class="sourceCode" id="cb3">
        <pre
            class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb3-1" title="1"><span class="va">assert</span>.<span class="at">equal</span>(<span class="kw">typeof</span> result[<span class="dv">0</span>]<span class="op">,</span> <span class="st">&#39;string&#39;</span>)<span class="op">;</span></a></code></pre>
    </div>
    <p><code>thinImage</code> should return an array of strings.</p>
    <div class="sourceCode" id="cb4">
        <pre
            class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb4-1" title="1"><span class="va">assert</span>.<span class="at">deepEqual</span>(result<span class="op">,</span> expected)<span class="op">;</span></a></code></pre>
    </div>
    <h1 id="seed">–seed–</h1>
    <h2 id="after-user-code">–after-user-code–</h2>
    <div class="sourceCode" id="cb5">
        <pre
            class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb5-1" title="1"><span class="kw">const</span> imageForTests <span class="op">=</span> [</a>
<a class="sourceLine" id="cb5-2" title="2">  <span class="st">&#39;                                                          &#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb5-3" title="3">  <span class="st">&#39; #################                   #############        &#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb5-4" title="4">  <span class="st">&#39; ##################               ################        &#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb5-5" title="5">  <span class="st">&#39; ###################            ##################        &#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb5-6" title="6">  <span class="st">&#39; ########     #######          ###################        &#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb5-7" title="7">  <span class="st">&#39;   ######     #######         #######       ######        &#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb5-8" title="8">  <span class="st">&#39;   ######     #######        #######                      &#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb5-9" title="9">  <span class="st">&#39;   #################         #######                      &#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb5-10" title="10">  <span class="st">&#39;   ################          #######                      &#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb5-11" title="11">  <span class="st">&#39;   #################         #######                      &#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb5-12" title="12">  <span class="st">&#39;   ######     #######        #######                      &#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb5-13" title="13">  <span class="st">&#39;   ######     #######        #######                      &#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb5-14" title="14">  <span class="st">&#39;   ######     #######         #######       ######        &#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb5-15" title="15">  <span class="st">&#39; ########     #######          ###################        &#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb5-16" title="16">  <span class="st">&#39; ########     ####### ######    ################## ###### &#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb5-17" title="17">  <span class="st">&#39; ########     ####### ######      ################ ###### &#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb5-18" title="18">  <span class="st">&#39; ########     ####### ######         ############# ###### &#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb5-19" title="19">  <span class="st">&#39;                                                          &#39;</span>]<span class="op">;</span></a>
<a class="sourceLine" id="cb5-20" title="20"><span class="kw">const</span> expected <span class="op">=</span> [</a>
<a class="sourceLine" id="cb5-21" title="21">  <span class="st">&#39;                                                          &#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb5-22" title="22">  <span class="st">&#39;                                                          &#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb5-23" title="23">  <span class="st">&#39;    # ##########                       #######            &#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb5-24" title="24">  <span class="st">&#39;     ##        #                   ####       #           &#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb5-25" title="25">  <span class="st">&#39;     #          #                 ##                      &#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb5-26" title="26">  <span class="st">&#39;     #          #                #                        &#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb5-27" title="27">  <span class="st">&#39;     #          #                #                        &#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb5-28" title="28">  <span class="st">&#39;     #          #                #                        &#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb5-29" title="29">  <span class="st">&#39;     ############               #                         &#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb5-30" title="30">  <span class="st">&#39;     #          #               #                         &#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb5-31" title="31">  <span class="st">&#39;     #          #                #                        &#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb5-32" title="32">  <span class="st">&#39;     #          #                #                        &#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb5-33" title="33">  <span class="st">&#39;     #          #                #                        &#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb5-34" title="34">  <span class="st">&#39;     #                            ##                      &#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb5-35" title="35">  <span class="st">&#39;     #                             ############           &#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb5-36" title="36">  <span class="st">&#39;                       ###                          ###   &#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb5-37" title="37">  <span class="st">&#39;                                                          &#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb5-38" title="38">  <span class="st">&#39;                                                          &#39;</span></a>
<a class="sourceLine" id="cb5-39" title="39">]<span class="op">;</span></a>
<a class="sourceLine" id="cb5-40" title="40"><span class="kw">const</span> result <span class="op">=</span> <span class="at">thinImage</span>(imageForTests)<span class="op">;</span></a></code></pre>
    </div>
    <h2 id="seed-contents">–seed-contents–</h2>
    <div class="sourceCode" id="cb6">
        <pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb6-1" title="1"><span class="kw">const</span> testImage <span class="op">=</span> [</a>
<a class="sourceLine" id="cb6-2" title="2">  <span class="st">&#39;                                                          &#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb6-3" title="3">  <span class="st">&#39; #################                   #############        &#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb6-4" title="4">  <span class="st">&#39; ##################               ################        &#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb6-5" title="5">  <span class="st">&#39; ###################            ##################        &#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb6-6" title="6">  <span class="st">&#39; ########     #######          ###################        &#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb6-7" title="7">  <span class="st">&#39;   ######     #######         #######       ######        &#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb6-8" title="8">  <span class="st">&#39;   ######     #######        #######                      &#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb6-9" title="9">  <span class="st">&#39;   #################         #######                      &#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb6-10" title="10">  <span class="st">&#39;   ################          #######                      &#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb6-11" title="11">  <span class="st">&#39;   #################         #######                      &#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb6-12" title="12">  <span class="st">&#39;   ######     #######        #######                      &#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb6-13" title="13">  <span class="st">&#39;   ######     #######        #######                      &#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb6-14" title="14">  <span class="st">&#39;   ######     #######         #######       ######        &#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb6-15" title="15">  <span class="st">&#39; ########     #######          ###################        &#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb6-16" title="16">  <span class="st">&#39; ########     ####### ######    ################## ###### &#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb6-17" title="17">  <span class="st">&#39; ########     ####### ######      ################ ###### &#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb6-18" title="18">  <span class="st">&#39; ########     ####### ######         ############# ###### &#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb6-19" title="19">  <span class="st">&#39;                                                          &#39;</span>]<span class="op">;</span></a>
<a class="sourceLine" id="cb6-20" title="20"></a>
<a class="sourceLine" id="cb6-21" title="21"><span class="kw">function</span> <span class="at">thinImage</span>(image) <span class="op">{</span></a>
<a class="sourceLine" id="cb6-22" title="22"></a>
<a class="sourceLine" id="cb6-23" title="23"><span class="op">}</span></a></code></pre>
    </div>
    <h1 id="solutions">–solutions–</h1>
    <div class="sourceCode" id="cb7">
        <pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb7-1" title="1"><span class="kw">function</span> <span class="at">Point</span>(x<span class="op">,</span> y) <span class="op">{</span></a>
<a class="sourceLine" id="cb7-2" title="2">  <span class="kw">this</span>.<span class="at">x</span> <span class="op">=</span> x<span class="op">;</span></a>
<a class="sourceLine" id="cb7-3" title="3">  <span class="kw">this</span>.<span class="at">y</span> <span class="op">=</span> y<span class="op">;</span></a>
<a class="sourceLine" id="cb7-4" title="4"><span class="op">}</span></a>
<a class="sourceLine" id="cb7-5" title="5"></a>
<a class="sourceLine" id="cb7-6" title="6"><span class="kw">const</span> ZhangSuen <span class="op">=</span> (<span class="kw">function</span> () <span class="op">{</span></a>
<a class="sourceLine" id="cb7-7" title="7">  <span class="kw">function</span> <span class="at">ZhangSuen</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb7-8" title="8">  <span class="op">}</span></a>
<a class="sourceLine" id="cb7-9" title="9"></a>
<a class="sourceLine" id="cb7-10" title="10">  <span class="va">ZhangSuen</span>.<span class="at">nbrs</span> <span class="op">=</span> [[<span class="dv">0</span><span class="op">,</span> <span class="dv">-1</span>]<span class="op">,</span> [<span class="dv">1</span><span class="op">,</span> <span class="dv">-1</span>]<span class="op">,</span> [<span class="dv">1</span><span class="op">,</span> <span class="dv">0</span>]<span class="op">,</span> [<span class="dv">1</span><span class="op">,</span> <span class="dv">1</span>]<span class="op">,</span> [<span class="dv">0</span><span class="op">,</span> <span class="dv">1</span>]<span class="op">,</span> [<span class="op">-</span><span class="dv">1</span><span class="op">,</span> <span class="dv">1</span>]<span class="op">,</span> [<span class="op">-</span><span class="dv">1</span><span class="op">,</span> <span class="dv">0</span>]<span class="op">,</span> [<span class="op">-</span><span class="dv">1</span><span class="op">,</span> <span class="dv">-1</span>]<span class="op">,</span> [<span class="dv">0</span><span class="op">,</span> <span class="dv">-1</span>]]<span class="op">;</span></a>
<a class="sourceLine" id="cb7-11" title="11"></a>
<a class="sourceLine" id="cb7-12" title="12">  <span class="va">ZhangSuen</span>.<span class="at">nbrGroups</span> <span class="op">=</span> [[[<span class="dv">0</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">4</span>]<span class="op">,</span> [<span class="dv">2</span><span class="op">,</span> <span class="dv">4</span><span class="op">,</span> <span class="dv">6</span>]]<span class="op">,</span> [[<span class="dv">0</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">6</span>]<span class="op">,</span> [<span class="dv">0</span><span class="op">,</span> <span class="dv">4</span><span class="op">,</span> <span class="dv">6</span>]]]<span class="op">;</span></a>
<a class="sourceLine" id="cb7-13" title="13"></a>
<a class="sourceLine" id="cb7-14" title="14">  <span class="va">ZhangSuen</span>.<span class="at">toWhite</span> <span class="op">=</span> []<span class="op">;</span></a>
<a class="sourceLine" id="cb7-15" title="15"></a>
<a class="sourceLine" id="cb7-16" title="16">  <span class="va">ZhangSuen</span>.<span class="at">main</span> <span class="op">=</span> <span class="kw">function</span> (image) <span class="op">{</span></a>
<a class="sourceLine" id="cb7-17" title="17">    <span class="va">ZhangSuen</span>.<span class="at">grid</span> <span class="op">=</span> <span class="kw">new</span> <span class="at">Array</span>(image)<span class="op">;</span></a>
<a class="sourceLine" id="cb7-18" title="18">    <span class="cf">for</span> (<span class="kw">let</span> r <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> r <span class="op">&lt;</span> <span class="va">image</span>.<span class="at">length</span><span class="op">;</span> r<span class="op">++</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb7-19" title="19">      <span class="va">ZhangSuen</span>.<span class="at">grid</span>[r] <span class="op">=</span> image[r].<span class="at">split</span>(<span class="st">&#39;&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb7-20" title="20">    <span class="op">}</span></a>
<a class="sourceLine" id="cb7-21" title="21">    <span class="va">ZhangSuen</span>.<span class="at">thinImage</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb7-22" title="22">    <span class="cf">return</span> <span class="va">ZhangSuen</span>.<span class="at">getResult</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb7-23" title="23">  <span class="op">};</span></a>
<a class="sourceLine" id="cb7-24" title="24"></a>
<a class="sourceLine" id="cb7-25" title="25">  <span class="va">ZhangSuen</span>.<span class="at">thinImage</span> <span class="op">=</span> <span class="kw">function</span> () <span class="op">{</span></a>
<a class="sourceLine" id="cb7-26" title="26">    <span class="kw">let</span> firstStep <span class="op">=</span> <span class="kw">false</span><span class="op">;</span></a>
<a class="sourceLine" id="cb7-27" title="27">    <span class="kw">let</span> hasChanged<span class="op">;</span></a>
<a class="sourceLine" id="cb7-28" title="28">    <span class="cf">do</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb7-29" title="29">      hasChanged <span class="op">=</span> <span class="kw">false</span><span class="op">;</span></a>
<a class="sourceLine" id="cb7-30" title="30">      firstStep <span class="op">=</span> <span class="op">!</span>firstStep<span class="op">;</span></a>
<a class="sourceLine" id="cb7-31" title="31">      <span class="cf">for</span> (<span class="kw">let</span> r <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> r <span class="op">&lt;</span> <span class="va">ZhangSuen</span>.<span class="va">grid</span>.<span class="at">length</span> <span class="op">-</span> <span class="dv">1</span><span class="op">;</span> r<span class="op">++</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb7-32" title="32">        <span class="cf">for</span> (<span class="kw">let</span> c <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> c <span class="op">&lt;</span> <span class="va">ZhangSuen</span>.<span class="at">grid</span>[<span class="dv">0</span>].<span class="at">length</span> <span class="op">-</span> <span class="dv">1</span><span class="op">;</span> c<span class="op">++</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb7-33" title="33">          <span class="cf">if</span> (<span class="va">ZhangSuen</span>.<span class="at">grid</span>[r][c] <span class="op">!==</span> <span class="st">&#39;#&#39;</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb7-34" title="34">            <span class="cf">continue</span><span class="op">;</span></a>
<a class="sourceLine" id="cb7-35" title="35">          <span class="op">}</span></a>
<a class="sourceLine" id="cb7-36" title="36">          <span class="kw">const</span> nn <span class="op">=</span> <span class="va">ZhangSuen</span>.<span class="at">numNeighbors</span>(r<span class="op">,</span> c)<span class="op">;</span></a>
<a class="sourceLine" id="cb7-37" title="37">          <span class="cf">if</span> (nn <span class="op">&lt;</span> <span class="dv">2</span> <span class="op">||</span> nn <span class="op">&gt;</span> <span class="dv">6</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb7-38" title="38">            <span class="cf">continue</span><span class="op">;</span></a>
<a class="sourceLine" id="cb7-39" title="39">          <span class="op">}</span></a>
<a class="sourceLine" id="cb7-40" title="40">          <span class="cf">if</span> (<span class="va">ZhangSuen</span>.<span class="at">numTransitions</span>(r<span class="op">,</span> c) <span class="op">!==</span> <span class="dv">1</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb7-41" title="41">            <span class="cf">continue</span><span class="op">;</span></a>
<a class="sourceLine" id="cb7-42" title="42">          <span class="op">}</span></a>
<a class="sourceLine" id="cb7-43" title="43">          <span class="cf">if</span> (<span class="op">!</span><span class="va">ZhangSuen</span>.<span class="at">atLeastOneIsWhite</span>(r<span class="op">,</span> c<span class="op">,</span> firstStep <span class="op">?</span> <span class="dv">0</span> : <span class="dv">1</span>)) <span class="op">{</span></a>
<a class="sourceLine" id="cb7-44" title="44">            <span class="cf">continue</span><span class="op">;</span></a>
<a class="sourceLine" id="cb7-45" title="45">          <span class="op">}</span></a>
<a class="sourceLine" id="cb7-46" title="46">          <span class="va">ZhangSuen</span>.<span class="va">toWhite</span>.<span class="at">push</span>(<span class="kw">new</span> <span class="at">Point</span>(c<span class="op">,</span> r))<span class="op">;</span></a>
<a class="sourceLine" id="cb7-47" title="47">          hasChanged <span class="op">=</span> <span class="kw">true</span><span class="op">;</span></a>
<a class="sourceLine" id="cb7-48" title="48">        <span class="op">}</span></a>
<a class="sourceLine" id="cb7-49" title="49">      <span class="op">}</span></a>
<a class="sourceLine" id="cb7-50" title="50">      <span class="cf">for</span> (<span class="kw">let</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> <span class="va">ZhangSuen</span>.<span class="va">toWhite</span>.<span class="at">length</span><span class="op">;</span> i<span class="op">++</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb7-51" title="51">        <span class="kw">const</span> p <span class="op">=</span> <span class="va">ZhangSuen</span>.<span class="at">toWhite</span>[i]<span class="op">;</span></a>
<a class="sourceLine" id="cb7-52" title="52">        <span class="va">ZhangSuen</span>.<span class="at">grid</span>[<span class="va">p</span>.<span class="at">y</span>][<span class="va">p</span>.<span class="at">x</span>] <span class="op">=</span> <span class="st">&#39; &#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb7-53" title="53">      <span class="op">}</span></a>
<a class="sourceLine" id="cb7-54" title="54">      <span class="va">ZhangSuen</span>.<span class="at">toWhite</span> <span class="op">=</span> []<span class="op">;</span></a>
<a class="sourceLine" id="cb7-55" title="55">    <span class="op">}</span> <span class="cf">while</span> ((firstStep <span class="op">||</span> hasChanged))<span class="op">;</span></a>
<a class="sourceLine" id="cb7-56" title="56">  <span class="op">};</span></a>
<a class="sourceLine" id="cb7-57" title="57"></a>
<a class="sourceLine" id="cb7-58" title="58">  <span class="va">ZhangSuen</span>.<span class="at">numNeighbors</span> <span class="op">=</span> <span class="kw">function</span> (r<span class="op">,</span> c) <span class="op">{</span></a>
<a class="sourceLine" id="cb7-59" title="59">    <span class="kw">let</span> count <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></a>
<a class="sourceLine" id="cb7-60" title="60">    <span class="cf">for</span> (<span class="kw">let</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> <span class="va">ZhangSuen</span>.<span class="va">nbrs</span>.<span class="at">length</span> <span class="op">-</span> <span class="dv">1</span><span class="op">;</span> i<span class="op">++</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb7-61" title="61">      <span class="cf">if</span> (<span class="va">ZhangSuen</span>.<span class="at">grid</span>[r <span class="op">+</span> <span class="va">ZhangSuen</span>.<span class="at">nbrs</span>[i][<span class="dv">1</span>]][c <span class="op">+</span> <span class="va">ZhangSuen</span>.<span class="at">nbrs</span>[i][<span class="dv">0</span>]] <span class="op">===</span> <span class="st">&#39;#&#39;</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb7-62" title="62">        count<span class="op">++;</span></a>
<a class="sourceLine" id="cb7-63" title="63">      <span class="op">}</span></a>
<a class="sourceLine" id="cb7-64" title="64">    <span class="op">}</span></a>
<a class="sourceLine" id="cb7-65" title="65">    <span class="cf">return</span> count<span class="op">;</span></a>
<a class="sourceLine" id="cb7-66" title="66">  <span class="op">};</span></a>
<a class="sourceLine" id="cb7-67" title="67"></a>
<a class="sourceLine" id="cb7-68" title="68">  <span class="va">ZhangSuen</span>.<span class="at">numTransitions</span> <span class="op">=</span> <span class="kw">function</span> (r<span class="op">,</span> c) <span class="op">{</span></a>
<a class="sourceLine" id="cb7-69" title="69">    <span class="kw">let</span> count <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></a>
<a class="sourceLine" id="cb7-70" title="70">    <span class="cf">for</span> (<span class="kw">let</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> <span class="va">ZhangSuen</span>.<span class="va">nbrs</span>.<span class="at">length</span> <span class="op">-</span> <span class="dv">1</span><span class="op">;</span> i<span class="op">++</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb7-71" title="71">      <span class="cf">if</span> (<span class="va">ZhangSuen</span>.<span class="at">grid</span>[r <span class="op">+</span> <span class="va">ZhangSuen</span>.<span class="at">nbrs</span>[i][<span class="dv">1</span>]][c <span class="op">+</span> <span class="va">ZhangSuen</span>.<span class="at">nbrs</span>[i][<span class="dv">0</span>]] <span class="op">===</span> <span class="st">&#39; &#39;</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb7-72" title="72">        <span class="cf">if</span> (<span class="va">ZhangSuen</span>.<span class="at">grid</span>[r <span class="op">+</span> <span class="va">ZhangSuen</span>.<span class="at">nbrs</span>[i <span class="op">+</span> <span class="dv">1</span>][<span class="dv">1</span>]][c <span class="op">+</span> <span class="va">ZhangSuen</span>.<span class="at">nbrs</span>[i <span class="op">+</span> <span class="dv">1</span>][<span class="dv">0</span>]] <span class="op">===</span> <span class="st">&#39;#&#39;</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb7-73" title="73">          count<span class="op">++;</span></a>
<a class="sourceLine" id="cb7-74" title="74">        <span class="op">}</span></a>
<a class="sourceLine" id="cb7-75" title="75">      <span class="op">}</span></a>
<a class="sourceLine" id="cb7-76" title="76">    <span class="op">}</span></a>
<a class="sourceLine" id="cb7-77" title="77">    <span class="cf">return</span> count<span class="op">;</span></a>
<a class="sourceLine" id="cb7-78" title="78">  <span class="op">};</span></a>
<a class="sourceLine" id="cb7-79" title="79"></a>
<a class="sourceLine" id="cb7-80" title="80">  <span class="va">ZhangSuen</span>.<span class="at">atLeastOneIsWhite</span> <span class="op">=</span> <span class="kw">function</span> (r<span class="op">,</span> c<span class="op">,</span> step) <span class="op">{</span></a>
<a class="sourceLine" id="cb7-81" title="81">    <span class="kw">let</span> count <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></a>
<a class="sourceLine" id="cb7-82" title="82">    <span class="kw">const</span> group <span class="op">=</span> <span class="va">ZhangSuen</span>.<span class="at">nbrGroups</span>[step]<span class="op">;</span></a>
<a class="sourceLine" id="cb7-83" title="83">    <span class="cf">for</span> (<span class="kw">let</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> <span class="dv">2</span><span class="op">;</span> i<span class="op">++</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb7-84" title="84">      <span class="cf">for</span> (<span class="kw">let</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;</span> group[i].<span class="at">length</span><span class="op">;</span> j<span class="op">++</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb7-85" title="85">        <span class="kw">const</span> nbr <span class="op">=</span> <span class="va">ZhangSuen</span>.<span class="at">nbrs</span>[group[i][j]]<span class="op">;</span></a>
<a class="sourceLine" id="cb7-86" title="86">        <span class="cf">if</span> (<span class="va">ZhangSuen</span>.<span class="at">grid</span>[r <span class="op">+</span> nbr[<span class="dv">1</span>]][c <span class="op">+</span> nbr[<span class="dv">0</span>]] <span class="op">===</span> <span class="st">&#39; &#39;</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb7-87" title="87">          count<span class="op">++;</span></a>
<a class="sourceLine" id="cb7-88" title="88">          <span class="cf">break</span><span class="op">;</span></a>
<a class="sourceLine" id="cb7-89" title="89">        <span class="op">}</span></a>
<a class="sourceLine" id="cb7-90" title="90">      <span class="op">}</span></a>
<a class="sourceLine" id="cb7-91" title="91">    <span class="op">}</span></a>
<a class="sourceLine" id="cb7-92" title="92">    <span class="cf">return</span> count <span class="op">&gt;</span> <span class="dv">1</span><span class="op">;</span></a>
<a class="sourceLine" id="cb7-93" title="93">  <span class="op">};</span></a>
<a class="sourceLine" id="cb7-94" title="94"></a>
<a class="sourceLine" id="cb7-95" title="95">  <span class="va">ZhangSuen</span>.<span class="at">getResult</span> <span class="op">=</span> <span class="kw">function</span> () <span class="op">{</span></a>
<a class="sourceLine" id="cb7-96" title="96">    <span class="kw">const</span> result <span class="op">=</span> []<span class="op">;</span></a>
<a class="sourceLine" id="cb7-97" title="97">    <span class="cf">for</span> (<span class="kw">let</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> <span class="va">ZhangSuen</span>.<span class="va">grid</span>.<span class="at">length</span><span class="op">;</span> i<span class="op">++</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb7-98" title="98">      <span class="kw">const</span> row <span class="op">=</span> <span class="va">ZhangSuen</span>.<span class="at">grid</span>[i].<span class="at">join</span>(<span class="st">&#39;&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb7-99" title="99">      <span class="va">result</span>.<span class="at">push</span>(row)<span class="op">;</span></a>
<a class="sourceLine" id="cb7-100" title="100">    <span class="op">}</span></a>
<a class="sourceLine" id="cb7-101" title="101">    <span class="cf">return</span> result<span class="op">;</span></a>
<a class="sourceLine" id="cb7-102" title="102">  <span class="op">};</span></a>
<a class="sourceLine" id="cb7-103" title="103">  <span class="cf">return</span> ZhangSuen<span class="op">;</span></a>
<a class="sourceLine" id="cb7-104" title="104"><span class="op">}</span>())<span class="op">;</span></a>
<a class="sourceLine" id="cb7-105" title="105"></a>
<a class="sourceLine" id="cb7-106" title="106"><span class="kw">function</span> <span class="at">thinImage</span>(image) <span class="op">{</span></a>
<a class="sourceLine" id="cb7-107" title="107">  <span class="cf">return</span> <span class="va">ZhangSuen</span>.<span class="at">main</span>(image)<span class="op">;</span></a>
<a class="sourceLine" id="cb7-108" title="108"><span class="op">}</span></a></code></pre>
    </div>
</body>

</html>
